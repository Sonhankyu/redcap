(("undefined"!==typeof self?self:this)["webpackJsonpcdp_mapping_vue"]=("undefined"!==typeof self?self:this)["webpackJsonpcdp_mapping_vue"]||[]).push([[1],{"00da":function(t,e,n){},"0176":function(t,e,n){"use strict";var a=n("cd68"),i=n.n(a);i.a},"0225":function(t,e,n){"use strict";var a=n("ad1d"),i=n.n(a);i.a},12760:function(t,e,n){},"1be0":function(t,e,n){},"1d24":function(t,e,n){},"21b9":function(t,e,n){},"40f6":function(t,e,n){"use strict";var a=n("1be0"),i=n.n(a);i.a},"47c7":function(t,e,n){"use strict";var a=n("00da"),i=n.n(a);i.a},"554b":function(t,e,n){},"5c30":function(t,e,n){"use strict";var a=n("fbcc"),i=n.n(a);i.a},"6cd5":function(t,e,n){"use strict";var a=n("1d24"),i=n.n(a);i.a},"6daf":function(t,e,n){"use strict";var a=n("73cf"),i=n.n(a);i.a},"72b1":function(t,e,n){},"73cf":function(t,e,n){},"8c73":function(t,e,n){},"8ffb":function(t,e,n){},9378:function(t,e,n){"use strict";var a=n("ccbb"),i=n.n(a);i.a},"97a9":function(t,e,n){"use strict";var a=n("b7fa"),i=n.n(a);i.a},"97ef":function(t,e,n){"use strict";var a=n("8ffb"),i=n.n(a);i.a},ad1d:function(t,e,n){},b19f:function(t,e,n){"use strict";var a=n("12760"),i=n.n(a);i.a},b7c6:function(t,e,n){"use strict";var a=n("8c73"),i=n.n(a);i.a},b7fa:function(t,e,n){},bc13:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",{staticClass:"text-justify"},[n("p",[t._v(t._s(t.translations["rws_description"]))]),n("p",[t._v(t._s(t.translations["rws_description_1"]))]),n("p",[n("span",[t._v(t._s(t.translations["rws_description_2"]))]),n("span",{staticClass:"d-block"},[n("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.onTellMeMoreClicked(e)}}},[t._v(t._s(t.translations["tell_me_more"])+".")])])]),n("MappingHelperPanel",{staticClass:"my-2"})],1),n("SettingsTable",{staticClass:"mb-2"}),n("MappingTable",{scopedSlots:t._u([{key:"head",fn:function(){return[n("ImportExport")]},proxy:!0}])}),n("SaveCancel",{staticClass:" mt-2"}),n("CDPInfoModal",{ref:"info-modal"})],1)},i=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("table",{ref:"table",staticClass:"table table-bordered table-hover"},[n("thead",{staticClass:"header thead-light"},[n("tr",[n("th",{attrs:{colspan:"6"}},[n("section",{staticClass:"d-flex flex-row justify-content-space-between align-items-center"},[n("span",{staticClass:"mr-auto"},[t._v(t._s(t.translations["mapping_table_title"]))]),t._t("head")],2)])]),n("tr",{directives:[{name:"show",rawName:"v-show",value:t.mapping.length>0,expression:"mapping.length>0"}],staticClass:"col-names"},[n("th",[n("span",{attrs:{title:t.fhirSourceName}},[t._v(t._s(t.translations["mapping_table_header_external_source"]))])]),n("th",[n("span",{attrs:{title:t.translations["mapping_table_header_event"]}},[t._v(t._s(t.translations["mapping_table_header_event"]))])]),n("th",[n("span",{attrs:{title:t.translations["mapping_table_header_field"]}},[t._v(t._s(t.translations["mapping_table_header_field"]))])]),n("th",[n("span",{attrs:{title:t.translations["mapping_table_header_date"]}},[t._v(t._s(t.translations["mapping_table_header_date"]))])]),n("th",[n("span",{attrs:{title:t.translations["mapping_table_header_preselect_strategy"]}},[t._v(t._s(t.translations["mapping_table_header_preselect_strategy"]))])]),n("th",[n("span",{attrs:{title:t.translations["mapping_table_header_actions"]}},[t._v(t._s(t.translations["mapping_table_header_actions"]))])])])]),n("transition-group",{attrs:{tag:"tbody",name:"list"}},[t._l(t.mapping,(function(e,a){return[n("tr",{directives:[{name:"show",rawName:"v-show",value:"deleted"!==e.status,expression:"item.status!=='deleted'"}],key:e.id,class:[t.getStatusClass(e),e===t.selected_mapping?"selected":""],attrs:{id:"row-"+e.id}},[n("td",[e.disabled?n("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-danger",attrs:{title:""+e.disabled_reason}},[n("font-awesome-icon",{attrs:{icon:["fas","exclamation-circle"],"fixed-width":""}})],1):t._e(),n("FhirFieldLabel",{class:{disabled:e.disabled},attrs:{identifier:e.is_record_identifier,name:e.fhir_field_name,label:e.fhir_label,category:e.category}})],1),n("td",[n("span",{attrs:{title:"Event ID: "+e.event_id}},[t._v(t._s(t.getEventName(e.event_id)))])]),n("td",[n("FieldLabel",{attrs:{title:"Field Name: "+e.field_name,field_name:e.field_name}})],1),n("td",[n("FieldLabel",{attrs:{title:"Temporal Field Name: "+e.temporal_field,field_name:e.temporal_field}})],1),n("td",[e.is_temporal?[n("PreselectLabel",{attrs:{value:e.preselect}})]:t._e()],2),n("td",{staticClass:"actions"},[n("div",{staticClass:" w-100 d-inline-flex flex-row align-items-center justify-content-end"},[n("b-button",{attrs:{id:"button-edit-"+e.id,variant:"outline-secondary",size:"sm"},on:{click:function(n){return t.onEditClicked(e,a)}}},[n("font-awesome-icon",{staticClass:"text-primary",attrs:{icon:["fas","edit"]}})],1),n("b-tooltip",{attrs:{target:"button-edit-"+e.id,placement:"bottom"}},[t._v("Edit")]),e.is_record_identifier?t._e():[n("b-button",{attrs:{id:"button-copy-"+e.id,title:t.translations["ws_112"],variant:"outline-secondary",size:"sm"},on:{click:function(n){return t.onCopyClicked(e)}}},[n("font-awesome-icon",{attrs:{icon:["fas","copy"]}})],1),n("b-tooltip",{attrs:{target:"button-copy-"+e.id,placement:"bottom"}},[t._v("Copy")])],[n("b-button",{attrs:{id:"button-delete-"+e.id,title:t.translations["ws_115"],variant:"outline-secondary",size:"sm"},on:{click:function(n){return t.onDeleteClicked(e)}}},[n("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:["fas","times"]}})],1),n("b-tooltip",{attrs:{target:"button-delete-"+e.id,placement:"bottom"}},[t._v("Delete")])]],2),e.has_errors?n("div",{staticClass:"alert alert-warning mt-2"},[n("span",{staticClass:"small"},[n("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:["fas","exclamation-triangle"]}}),t._v(" Revision needed")],1),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"validation-errors-modal-"+e.id,expression:"`validation-errors-modal-${item.id}`"}],attrs:{size:"sm"}},[t._v("details...")]),n("b-modal",{attrs:{id:"validation-errors-modal-"+e.id,title:"Validation errors","ok-only":""}},[n("ul",t._l(e.validation_errors,(function(e,a){return n("li",{key:a},[n("span",[t._v(t._s(e))])])})),0)])],1):t._e(),t.mapping_duplicates.indexOf(e.id)>-1?n("div",{staticClass:"duplicate-warning"},[n("span",{staticClass:"small text-muted"},[n("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:["fas","exclamation-triangle"]}}),t._v(" duplicate")],1)]):t._e(),t.mapping_record_identifiers.indexOf(e.id)>0?n("div",{staticClass:"duplicate-warning"},[n("span",{staticClass:"small text-muted"},[n("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:["fas","exclamation-triangle"]}}),t._v(" record identifier already set")],1)]):t._e()])])]}))],2),n("tfoot",{staticClass:"thead-light"},[n("tr",[n("th",{attrs:{scope:"row",colspan:"6"}},[t._t("foot"),n("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"button"},on:{click:t.onNewItemClicked}},[n("font-awesome-icon",{attrs:{icon:"plus-circle"}}),n("span",[t._v(" "+t._s(t.translations["find_more_sources_fields_to_map"]))])],1)],2)])])],1),n("b-modal",{attrs:{title:"Edit","hide-footer":""},model:{value:t.show_edit,callback:function(e){t.show_edit=e},expression:"show_edit"}},[n("MappingForm",{attrs:{mapping:t.getMappingConfig(t.selected_mapping)},scopedSlots:t._u([{key:"footer",fn:function(e){var a=e.config,i=e.validation;return[n("div",{staticClass:"d-flex justify-content-end"},[n("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show_edit=!1}}},[t._v("Cancel")]),n("b-button",{attrs:{size:"sm",variant:"success",disabled:i.$invalid},on:{click:function(e){return t.update(t.selected_mapping,a)}}},[t._v("OK")])],1)]}}])})],1),n("b-modal",{attrs:{title:"Create","hide-footer":""},model:{value:t.show_create,callback:function(e){t.show_create=e},expression:"show_create"}},[n("MappingForm",{attrs:{mapping:t.new_mapping},scopedSlots:t._u([{key:"footer",fn:function(e){var a=e.config,i=e.validation;return[n("div",{staticClass:"d-flex justify-content-end"},[n("b-button",{staticClass:"mr-2",attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show_create=!1}}},[t._v("Cancel")]),n("b-button",{attrs:{size:"sm",variant:"success",disabled:i.$invalid},on:{click:function(e){return t.create(a)}}},[t._v("OK")])],1)]}}])})],1)],1)},r=[],o=(n("b64b"),n("96cf"),n("1da1")),l=n("53ca"),c=n("5530"),d=n("2f62"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.field_data?n("span",{attrs:{title:t.title}},[n("span",{staticClass:"d-block small font-weight-bold"},[t._v(t._s(t.field_data.field_name))]),n("span",{staticClass:"d-block",domProps:{innerHTML:t._s(t.field_data.element_label)}}),n("span",{staticClass:"d-block small muted font-italic"},[t._v("("+t._s(t.form_data.menu)+")")])]):t._e()},p=[],f={data:function(){return{field_data:{},form_data:{}}},computed:{},props:{field_name:{type:String,default:""},title:{type:String,default:""}},methods:{getFieldData:function(t){return this.$store.getters["app_settings/getFieldData"](t)},getFormData:function(t){return this.$store.getters["app_settings/getFormData"](t)}},watch:{field_name:{immediate:!0,handler:function(t){this.field_data=this.getFieldData(t);var e=Object(c["a"])({},this.field_data),n=e.form_name;this.form_data=this.getFormData(n)}}}},_=f,m=n("2877"),v=Object(m["a"])(_,u,p,!1,null,null,null),b=v.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"fhir-field-label"},[t.identifier?[n("span",{staticClass:"identifier small mr-2"},[t._v("("),n("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:"star"}}),t._v(t._s(t.translations["source_identifier_field"])+")")],1)]:t._e(),n("span",{directives:[{name:"show",rawName:"v-show",value:t.name,expression:"name"}],staticClass:"small font-weight-bold"},[t._v(t._s(t.name))]),n("span",{staticClass:"d-block"},[t._v(t._s(t.label))]),t.category?n("span",{staticClass:"d-block font-italic small"},[t._v("("+t._s(t.category)+")")]):t._e()],2)},g=[],w={computed:Object(c["a"])({},Object(d["c"])({translations:function(t){return t.app_settings.translations}})),props:{identifier:{type:Boolean,default:!1},name:{type:String,default:""},label:{type:String,default:""},category:{type:String,default:""}}},y=w,j=(n("0176"),Object(m["a"])(y,h,g,!1,null,"5c5b2872",null)),x=j.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{domProps:{textContent:t._s(t.label)}})},k=[],O=(n("7db0"),{computed:{options:function(){return this.$store.getters["app_settings/getPreselectOptions"]},label:function(){var t=this,e=this.options.find((function(e){return e.value===t.value}));return e?e.label:""}},props:{value:{type:String,default:""}}}),$=O,F=Object(m["a"])($,C,k,!1,null,null,null),S=F.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"fhir-field"}},[t._v(t._s(t.translations["form_label_fhir_field"]))]),n("FhirFieldsSelect",{model:{value:t.external_source_field_name,callback:function(e){t.external_source_field_name=e},expression:"external_source_field_name"}})],1),n("div",{staticClass:"form-group mt-2 d-flex redcap-event-field"},[n("div",[n("label",{},[t._v(t._s(t.translations["form_label_redcap_event"]))]),n("Events",{staticClass:"w-100",attrs:{options:t.arms,disabled:t.events_disabled},model:{value:t.event_id,callback:function(e){t.event_id=e},expression:"event_id"}})],1),n("div",{staticClass:"ml-2"},[n("label",{},[t._v(t._s(t.translations["form_label_redcap_field"]))]),n("Fields",{attrs:{options:t.getForms(t.event_id)},model:{value:t.redcap_field,callback:function(e){t.redcap_field=e},expression:"redcap_field"}})],1)]),n("div",{staticClass:"form-group mt-2 d-flex"},[n("div",{staticClass:"w-100"},[n("label",{attrs:{for:"datetime-field"}},[t._v(t._s(t.translations["form_label_date_time"]))]),n("Fields",{attrs:{options:t.groupedTemporalFields,disabled:t.disabledTemporal},model:{value:t.temporal_field,callback:function(e){t.temporal_field=e},expression:"temporal_field"}})],1),n("div",{staticClass:"w-100 ml-2"},[n("label",{attrs:{for:"preselect-field"}},[t._v(t._s(t.translations["form_label_preselect_strategy"]))]),n("SelectPreselectedValue",{attrs:{disabled:t.disabledTemporal},model:{value:t.preselect_value,callback:function(e){t.preselect_value=e},expression:"preselect_value"}})],1)]),n("footer",[t._t("footer",null,{config:t.config,validation:t.$v})],2)])},M=[],P=(n("45fc"),n("b5ae")),N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"form-control-sm",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:""}},[t._v("-- none --")]),t._l(t.options,(function(e,a){return n("optgroup",{key:a,attrs:{label:a}},t._l(e||[],(function(e,a){return n("option",{key:a,domProps:{value:a}},[t._v(t._s(e))])})),0)}))],2)},A=[],D=(n("a9e3"),{computed:{selected:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},props:{options:{type:[Array,Object],default:function(){return[]}},value:{type:[Number,String],default:""}}}),I=D,T=Object(m["a"])(I,N,A,!1,null,null,null),z=T.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.label?n("span",{staticClass:"label"},[t._v(t._s(t.label))]):n("span",{staticClass:"label"},[t._v("Select...")])]},proxy:!0}])},"b-dropdown",t.$attrs,!1),t._l(t.options||[],(function(e,a){return n("b-dropdown-item-button",{key:a,attrs:{active:e.value===t.selected},on:{click:function(n){t.selected=e.value}}},[n("span",[t._v(t._s(e.label))])])})),1)},L=[],H=n("b85c"),B={computed:{selected:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},label:function(){var t,e=Object(H["a"])(this.options);try{for(e.s();!(t=e.n()).done;){var n=t.value,a=n.value,i=n.label;if(a==this.value)return i}}catch(s){e.e(s)}finally{e.f()}return!1},options:function(){var t=this.$store.getters["app_settings/getPreselectOptions"];return t}},props:{value:{type:[Number,String],default:null}}},V=B,q=(n("6daf"),Object(m["a"])(V,R,L,!1,null,"059eeb96",null)),G=q.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("b-dropdown",{ref:"dropdown",staticClass:"fhir-dropdown",attrs:{text:t.dropDownText,block:"",lazy:"",variant:"outline-secondary",size:"sm","menu-class":"w-100"},on:{shown:t.onDropdownShown}},[n("b-dropdown-form",[n("b-form-group",{staticClass:"my-0",attrs:{label:"","label-for":"filter-fields"},on:{submit:function(t){t.stopPropagation(),t.preventDefault()}}},[n("b-form-input",{ref:"filter",attrs:{id:"filter-fields",size:"sm",placeholder:"filter fields...",autocomplete:"off"},on:{input:t.onFilterInput},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1)],1),n("b-dropdown-text",[n("SelectNode",{attrs:{data:t.groups,id:"nodes"}})],1)],1)],1)},Y=[],K=(n("a4d3"),n("e01a"),n("99af"),n("4de4"),n("4d63"),n("ac1f"),n("25f0"),n("466d"),n("498a"),n("2909")),Q=n("2ef0"),U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.hasVisibleChildren?n("div",{staticClass:"main",style:{marginLeft:20*(t.depth-1)+"px"}},[t.name?n("header",{staticClass:"group-head"},[n("div",{staticClass:"group-name",on:{click:t.toggleCollapse}},[n("font-awesome-icon",{staticClass:"mr-1",class:{"fa-rotate-90":!t.collapsed},attrs:{icon:"angle-right"}}),t.name?n("strong",[t._v(t._s(t.name))]):t._e(),n("div",{staticClass:"small text-muted"},[t.hidden_fields.length>0?n("span",[t._v(" (showing "+t._s(t.visible_fields.length)+" of "+t._s(t.fields.length)+" field"+t._s(1==t.fields.length?"":"s")+")")]):t._e()])],1)]):t._e(),t.collapsed?t._e():[t._l(t.data,(function(e,a){return["field"in e&&!e.hidden?n("Leaf",{key:"cat_"+a,attrs:{data:e},nativeOn:{click:function(n){return t.onLeafClicked(e)}}}):"field"in e?t._e():n("SelectNode",{key:"cat_"+a,attrs:{name:a,data:e,depth:t.depth+1}})]}))]],2):t._e()},W=[],X=(n("c975"),n("b0c0"),n("4fad"),n("3835")),Z=n("8bbf"),tt=n.n(Z),et=new tt.a,nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"leaf"},[n("label",{attrs:{for:"checkbox_"+t.data.field}},[n("span",{class:{disabled:t.data.disabled},domProps:{innerHTML:t._s("• "+t.data.field+" ("+t.data.label+")")}}),n("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:""+t.data.description}},[n("font-awesome-icon",{staticClass:"ml-2",attrs:{icon:"info-circle"}})],1)]),t.data.disabled?n("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-danger",attrs:{title:""+t.data.disabled_reason}},[n("font-awesome-icon",{attrs:{icon:["fas","exclamation-circle"],"fixed-width":""}})],1):t._e()])},at=[],it={props:{data:{type:Object,default:function(){return{}}}}},st=it,rt=(n("47c7"),n("97a9"),Object(m["a"])(st,nt,at,!1,null,"4ddf346b",null)),ot=rt.exports,lt={name:"SelectNode",components:{Node:Node,Leaf:ot},data:function(){return{is_collapsed:!0,metadata:{},selected:[]}},props:{data:{type:Object,default:function(){return{}}},depth:{type:Number,default:0},name:{type:String,default:""},value:{type:Object,default:null}},computed:{fields:function(){var t=this.metadata.fields,e=void 0===t?[]:t;return e},hidden_fields:function(){var t=this.metadata.hidden_fields,e=void 0===t?[]:t;return e},visible_fields:function(){var t=this.metadata,e=t.fields,n=void 0===e?[]:e,a=t.hidden_fields,i=void 0===a?[]:a,s=n.filter((function(t){return i.indexOf(t)<0}));return s},hasVisibleChildren:function(){return this.visible_fields.length>0},collapsed:{get:function(){return""!==this.name.trim()&&this.is_collapsed},set:function(t){this.is_collapsed=t}}},methods:{onLeafClicked:function(t){et.$emit("fieldSelected",t)},toggleCollapse:function(){this.collapsed=!this.collapsed},parseChildren:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fields:[],hidden_fields:[]},n=0,a=Object.entries(t);n<a.length;n++){var i=Object(X["a"])(a[n],2),s=i[0],r=i[1];"object"==Object(l["a"])(r)&&"field"in r?(e.fields.push(s),"hidden"in r&&1==r.hidden&&e.hidden_fields.push(s)):e=this.parseChildren(r,e)}return e}},watch:{data:{immediate:!0,deep:!0,handler:function(t){this.metadata=this.parseChildren(t)}},visible_fields:{immediate:!0,deep:!0,handler:function(t,e){var n=this.$store.state.fhir_fields_select.filter;""==n.trim()?this.is_collapsed=!0:t.length>0&&(this.is_collapsed=!1)}}}},ct=lt,dt=(n("5c30"),Object(m["a"])(ct,U,W,!1,null,"040dfdbd",null)),ut=dt.exports,pt={components:{SelectNode:ut},data:function(){return{filter:"",filtered_fields:[],groups:{}}},props:{value:{type:String,default:null}},created:function(){var t=this;et.$on("fieldSelected",this.onFieldSelected);var e=function(){t.onFilterInput=Object(Q["debounce"])((function(e){t.setGroups()}),400)};e()},destroyed:function(){et.$off("fieldSelected",this.onFieldSelected)},computed:Object(c["a"])(Object(c["a"])({},Object(d["c"])({fields:function(t){return t.fhir_fields_select.fields},mapping:function(t){return t.mapping.list}})),{},{dropDownText:function(){if(!this.fhir_field)return"Select...";var t=this.fhir_field,e=t.field,n=t.description;return"".concat(e," (").concat(n,")")},fhir_field:function(){if(this.selected){var t=this.$store.getters["app_settings/getFhirField"](this.selected);return t}},selected:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}),methods:{onDropdownShown:function(){var t=this.$refs.filter;t&&t.focus()},onFieldSelected:function(t){this.selected=t.field,this.$refs.dropdown.hide()},getSkipFields:function(){var t="id",e=Object(K["a"])(this.mapping),n=[],a=e.some((function(e){return e.fhir_field_name===t}));return a&&n.push(t),n},setGroups:function(){var t,e=Object(K["a"])(this.fields),n={},a=Object(H["a"])(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i=this.applyFilter(this.filter,i),i){var s=i.category||"",r=i.subcategory||"",o=i.field||"";"undefined"===typeof n[s]&&(n[s]={}),""!=r.trim()?("undefined"===typeof n[s][r]&&(n[s][r]={}),n[s][r][o]=i):n[s][o]=i}}}catch(l){a.e(l)}finally{a.f()}this.groups=Object(c["a"])({},n)},applyFilter:function(t,e){var n=new RegExp("(".concat(t,")"),"ig"),a=[e.field,e.category,e.subcategory,e.label,e.description],i=a.some((function(t){return"string"===typeof t&&t.match(n)}));return e.hidden=!i,e}},watch:{fields:{immediate:!0,handler:function(){this.setGroups()}}}},ft=pt,_t=(n("97ef"),Object(m["a"])(ft,J,Y,!1,null,"3c66e1c7",null)),mt=_t.exports,vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",{class:{show:t.show},attrs:{id:"dropdown",role:"navigation"}},[n("button",{on:{click:function(e){t.show=!t.show},blur:t.onBlur}},[t._v("events")]),n("ul",t._l(t.project.arms,(function(e,a){return n("li",{key:a},[n("span",[t._v(t._s(e.name))]),n("ul",t._l(e.events,(function(e,a){return n("li",{key:a},[n("span",[t._v(t._s(e.descrip))]),t.project.events_forms[a]?n("ul",t._l(t.project.events_forms[a],(function(e,a){return n("li",{key:a},[n("span",[t._v(t._s(t.project.forms[e].menu))]),n("ul",t._l(t.project.forms[e].fields,(function(e,a){return n("li",{key:a},[n("span",[t._v(t._s(e)+" ("+t._s(a)+")")])])})),0)])})),0):t._e()])})),0)])})),0)])},bt=[],ht=(n("a434"),{data:function(){return{open:[],show:!1}},computed:Object(c["a"])({},Object(d["c"])({project:function(t){return t.app_settings.project}})),mounted:function(){var t=this;this.$el.$on("bv::dropdown::show",(function(e){t.open.push(e.vueTarget)})),this.$el.$on("bv::dropdown::hide",(function(e){var n=t.open.indexOf(e.vueTarget);if(n<0||n==open.length-1){var a=Object(K["a"])(t.open);a.splice(n,1),t.open=a}else{var i=t.$refs.wrapper.querySelectorAll("*:focus");i.length>0?e.preventDefault():t.open=[]}}))},methods:{onBlur:function(t){console.log(t)}}}),gt=ht,wt=(n("40f6"),Object(m["a"])(gt,vt,bt,!1,null,"4312e117",null)),yt=wt.exports,jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",{staticClass:"wrapper"},[t._t("event-header",[n("span",{staticClass:"small"},[t._v("Event")])]),n("Events",{attrs:{options:t.arms},model:{value:t.selected_event_id,callback:function(e){t.selected_event_id=e},expression:"selected_event_id"}})],2),n("section",{staticClass:"wrapper"},[t._t("field-header",[n("span",{staticClass:"small"},[t._v("Field")])]),n("Fields",{attrs:{options:t.forms},model:{value:t.selected_field_key,callback:function(e){t.selected_field_key=e},expression:"selected_field_key"}})],2)])},xt=[],Ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.label?n("span",{staticClass:"label"},[t._v(t._s(t.label))]):n("span",{staticClass:"label"},[t._v("Select...")])]},proxy:!0}])},"b-dropdown",t.$attrs,!1),[t.options_length<1?n("b-dropdown-text",[t._v("No data")]):t._l(t.options,(function(e,a){return n("b-dropdown-group",{key:a},[n("b-dropdown-header",[n("span",[t._v(t._s(t.getArmLabel(a,e.name)))])]),t._l(e.events||[],(function(i,s){return n("b-dropdown-item-button",{directives:[{name:"show",rawName:"v-show",value:t.eventHasForms(s),expression:"eventHasForms(event_id)"}],key:s,attrs:{active:s===t.selected},on:{click:function(n){return t.onClick(s,e,a)}}},[n("span",[t._v(t._s(i.descrip)+" ("+t._s(t.getArmLabel(a,e.name))+")")])])})),n("b-dropdown-divider")],2)}))],2)},kt=[],Ot=(n("07ac"),{computed:{selected:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},options_length:function(){var t=this.options;return Object.values(t).length},events_forms:function(){var t=this.$store.state.app_settings.project;t=void 0===t?{}:t;var e=t.events_forms,n=void 0===e?{}:e;return n},events:function(){return this.$store.state.app_settings.project.events},label:function(){if(this.events){var t=this.events[this.selected];if(t){var e=t.arm_num,n=void 0===e?"":e,a=t.arm_name,i=void 0===a?"":a,s=t.name,r=void 0===s?"":s;return"".concat(r," (Arm ").concat(n,": ").concat(i,")")}}}},props:{options:{type:[Object],default:function(){return{}}},value:{type:[Number,String],default:""}},methods:{onClick:function(t,e,n){this.selected=t,this.arm_index=n,this.arm_name=e.name||""},eventHasForms:function(t){try{var e=this.events_forms[t]||[];return e.length>0}catch(n){return!1}},getArmLabel:function(t,e){return"Arm ".concat(t,": ").concat(e)}}}),$t=Ot,Ft=(n("effd"),Object(m["a"])($t,Ct,kt,!1,null,"47cb2636",null)),St=Ft.exports,Et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-dropdown",t._b({staticClass:"redcap-field-dropdown scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},on:{shown:t.onDropdownShown},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.selected?n("span",{staticClass:"label"},[t._v(t._s(t.selected))]):n("span",{staticClass:"label"},[t._v("Select..."+t._s(t.selected))])]},proxy:!0}])},"b-dropdown",t.$attrs,!1),[t.options_length<1?n("b-dropdown-text",[t._v("No data")]):[n("b-dropdown-form",[n("b-form-group",{staticClass:"my-0",attrs:{label:"","label-for":"filter-fields"},on:{submit:function(t){t.stopPropagation(),t.preventDefault()}}},[n("b-form-input",{ref:"filter",attrs:{id:"filter-fields",size:"sm",placeholder:"filter fields...",autocomplete:"off"},on:{input:t.onFilterInput},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1)],1),n("section",{staticClass:"content"},[n("b-dropdown-item-button",{attrs:{active:null==t.selected},on:{click:function(e){t.selected=null}}},[t._v("-- none --")]),t._l(t.filtered_options,(function(e,a){return n("b-dropdown-group",{key:a},[n("b-dropdown-header",{staticClass:"bg-light"},[n("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.getFormData(a).menu))])]),t._l(e||[],(function(e,a){return n("b-dropdown-item-button",{key:a,attrs:{title:e.element_label,active:t.selected===e.field_name},on:{click:function(n){t.selected=e.field_name}}},[n("span",[t._v(t._s(e.field_name))]),n("span",{staticClass:"d-block muted small font-italic",domProps:{innerHTML:t._s(e.element_label)}})])})),n("b-dropdown-divider")],2)}))],2)]],2)],1)},Mt=[],Pt=(n("4160"),n("159b"),{data:function(){return{filter:"",filtered_options:{}}},computed:Object(c["a"])(Object(c["a"])({},Object(d["b"])({getFormData:"app_settings/getFormData"})),{},{selected:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},options_length:function(){var t=this.options;return Object.values(t).length}}),created:function(){var t=this,e=function(){t.onFilterInput=Object(Q["debounce"])((function(e){t.filterOptions()}),400)};e()},props:{options:{type:[Object],default:function(){return[]}},value:{type:[Number,String],default:null}},methods:{filterOptions:function(){var t=this.filter;if(""!==t.trim()){for(var e={},n=0,a=Object.entries(this.options);n<a.length;n++){var i=Object(X["a"])(a[n],2),s=i[0],r=i[1],o=this.filterFormOptions(t,r);o.length>0&&(e[s]=o)}this.filtered_options=Object(c["a"])({},e)}else this.filtered_options=Object(c["a"])({},this.options)},filterFormOptions:function(t,e){var n=[],a=new RegExp(t,"i"),i=["element_label","field_name"];return e.forEach((function(t){var e=i.some((function(e){return t[e].match(a)}));!1!==e&&n.push(t)})),n},isValueInOptions:function(){for(var t=this,e=[],n=0,a=Object.entries(this.options);n<a.length;n++){var i=Object(X["a"])(a[n],2),s=(i[0],i[1]);e=[].concat(Object(K["a"])(e),Object(K["a"])(s))}var r=e.some((function(e){return e.field_name==t.value}));return r||(this.selected=null),r},onDropdownShown:function(){var t=this.$refs.filter;t&&t.focus()}},watch:{options:{immediate:!0,handler:function(){this.filterOptions(),this.isValueInOptions()}}}}),Nt=Pt,At=(n("b7c6"),Object(m["a"])(Nt,Et,Mt,!1,null,"91bf32f0",null)),Dt=At.exports,It={components:{Events:St,Fields:Dt},props:{event:{type:String,default:""},field:{type:String,default:""}},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({selected_event_id:{get:function(){return this.event},set:function(t){var e={event:t,field:null};this.$emit("input",e)}},selected_field_key:{get:function(){return this.field},set:function(t){var e={event:this.event,field:t};this.$emit("input",e)}}},Object(d["c"])({project:function(t){return t.app_settings.project}})),Object(d["b"])({groupedFields:"app_settings/groupedProjectFields"})),{},{arms:function(){var t=this.project.arms;return t},events_forms:function(){var t=this.project.events_forms;return t},forms:function(){var t=this.selected_event_id;return this.$store.getters["app_settings/getForms"](t)}})},Tt=It,zt=(n("e662"),Object(m["a"])(Tt,jt,xt,!1,null,"6cff68ce",null)),Rt=zt.exports,Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._t("button-content",[t.selected?n("span",{staticClass:"label"},[t._v(t._s(t.selected))]):n("span",{staticClass:"label"},[t._v("Select a field...")])])]},proxy:!0}],null,!0)},"b-dropdown",t.$attrs,!1),[t.options_length<1?n("b-dropdown-text",[t._v("No data")]):[t._t("default",t._l(t.options||[],(function(e,a){return n("b-dropdown-item-button",{key:a,attrs:{active:a===t.selected},on:{click:function(e){t.selected=a}}},[n("span",[t._v(t._s(e))])])})))]],2)},Ht=[],Bt={computed:{selected:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},options_length:function(){var t=this.options;return Array.isArray(t)?t.length:Object.values(t).length}},props:{options:{type:[Object,Array],default:function(){return[]}},value:{type:[Number,String],default:""}}},Vt=Bt,qt=(n("f57a"),Object(m["a"])(Vt,Lt,Ht,!1,null,"6d35b686",null)),Gt=qt.exports,Jt={components:{SelectProjectField:z,SelectPreselectedValue:G,FhirFieldsSelect:mt,EventFieldsDropDown:yt,RedcapFieldSelect:Rt,Fields:Dt,Events:St},data:function(){return{temporal_field:null,preselect_value:null,event_id:"",redcap_field:"",external_source_field_name:""}},props:{mapping:{type:Object,default:null}},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(d["c"])({translations:function(t){return t.app_settings.translations},project:function(t){return t.app_settings.project},project_id:function(t){return t.app_settings.project_id}})),Object(d["b"])({groupedTemporalFields:"app_settings/groupedProjectTemporalFields"})),{},{events_disabled:function(){var t=parseInt(this.event_id);if(isNaN(t))return!1;var e=Object.keys(this.events),n=1===e.length;if(!n)return!1;var a=e.some((function(e){return t==e}));return!!a},disabledTemporal:function(){return!this.fhir_field||1!=this.fhir_field.temporal},fhir_field:function(){if(!this.external_source_field_name)return{};var t=this.$store.getters["app_settings/getFhirField"](this.external_source_field_name);return t},arms:function(){return this.project.arms},events:function(){return this.project.events},config:function(){if(this.fhir_field){var t=this.fhir_field,e=t.field,n=t.identifier,a={event_id:this.event_id,external_source_field_name:e,field_name:this.redcap_field,identifier:n,preselect:this.preselect_value,temporal_field:this.temporal_field};return a}}}),methods:{getForms:function(t){return this.$store.getters["app_settings/getForms"](t)}},watch:{mapping:{immediate:!0,handler:function(t){t&&(this.event_id=t.event_id,this.temporal_field=t.temporal_field,this.preselect_value=t.preselect,this.redcap_field=t.field_name,this.external_source_field_name=t.external_source_field_name)}},disabledTemporal:{immediate:!0,handler:function(t){t&&(this.temporal_field=null,this.preselect_value=null)}}},validations:function(){return{fhir_field:{required:P["required"]},redcap_field:{required:P["required"]}}}},Yt=Jt,Kt=(n("0225"),Object(m["a"])(Yt,E,M,!1,null,"3d1b1830",null)),Qt=Kt.exports,Ut=n("3a34"),Wt={components:{FieldLabel:b,FhirFieldLabel:x,PreselectLabel:S,MappingForm:Qt},data:function(){return{sort_by:null,modal_component:null,mapping_proxy:[],selected_mapping:null,show_edit:!1,show_create:!1,new_mapping:null}},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(d["c"])({translations:function(t){return t.app_settings.translations},fhirSourceName:function(t){return t.app_settings.fhir_source_name},project:function(t){return t.app_settings.project},project_temporal_fields:function(t){return t.app_settings.project_temporal_fields},fhir_fields:function(t){return t.app_settings.fhir_fields},mapping:function(t){return t.mapping.list}})),Object(d["b"])({groupedTemporalFields:"app_settings/groupedProjectTemporalFields",mapping_duplicates:"mapping/duplicates",mapping_record_identifiers:"mapping/recordIdentifiers"})),{},{arms:function(){return this.project.arms},events:function(){return this.project.events}}),methods:{getEventName:function(t){var e=this.$store.getters["app_settings/getEventData"](t);return"object"===Object(l["a"])(e)&&"name_ext"in e?e.name_ext:""},onNewItemClicked:function(){var t={},e=Object.keys(this.events);1===e.length&&(t.event_id=e[0]),this.new_mapping=Object(c["a"])({},t),this.show_create=!0},updateMapping:function(t,e){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.$store.dispatch("mapping/update",{item:t,params:e});case 2:case"end":return a.stop()}}),a)})))()},scrollToElement:function(t){if(t){var e=t.getBoundingClientRect(),n=window.scrollY;window.scrollTo({top:n+e.top,behavior:"smooth"})}},onDeleteClicked:function(t){this.$store.dispatch("mapping/deleteRow",t)},onCopyClicked:function(t){this.$store.dispatch("mapping/duplicateRow",t)},onEditClicked:function(t,e){this.selected_mapping=t,this.show_edit=!0},update:function(t,e){this.show_edit=!1,this.updateMapping(t,e)},create:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.dispatch("mapping/addRow",t);case 2:n.sent,e.show_create=!1;case 4:case"end":return n.stop()}}),n)})))()},getStatusClass:function(t){var e=t.status,n=void 0===e?"":e,a="status-";switch(n){case"new":a+="new";break;default:a+="normal";break}return t.dirty&&(a+=" dirty"),a},sortBy:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.dispatch("mapping/sortBy",t);case 2:e.sort_by=n.sent;case 3:case"end":return n.stop()}}),n)})))()},getMappingConfig:function(t){return t instanceof Ut["a"]?t.config:{}}}},Xt=Wt,Zt=(n("9378"),Object(m["a"])(Xt,s,r,!1,null,"348e74e2",null)),te=Zt.exports,ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("table",{staticClass:"table table-bordered"},[n("thead",{staticClass:"thead-light"},[n("tr",[n("th",{attrs:{colspan:"2"}},[n("span",[t._v(t._s(t.translations["settings_table_title"]))])])])]),n("tbody",[n("tr",[n("td",[n("h6",[t._v(t._s(t.translations["preview_fields_title"]))]),n("p",[t._v(t._s(t.translations["preview_fields_description"]))])]),n("td",[n("label",{attrs:{for:"select-preview-field"}},[n("span",[t._v(t._s(t.translations["preview_fields_select_label"]))]),t._v(" "),n("em",[t._v(t._s(t.fhirSourceName))]),t._v(" "),n("span",[t._v(t._s(t.translations["preview_fields_select_up_to"]))])]),n("PreviewFields")],1)]),n("tr",[n("td",[n("h6",[t._v(t._s(t.translations["default_day_offset_title"]))]),n("p",[t._v(t._s(t.translations["default_day_offset_description"]))])]),n("td",[n("label",{attrs:{for:"day-offset"}},[t._v(t._s(t.translations["default_day_offset_label"]))]),n("DaysOffset")],1)]),n("tr",[n("td",[n("h6",[t._v(t._s(t.translations["instant_adjudication_title"]))]),n("p",[t._v(t._s(t.translations["instant_adjudication_description"]))])]),n("td",[n("label",{staticClass:"mr-2",attrs:{for:"auto-adjudication"}},[t._v(t._s(t.translations["instant_adjudication_label"]))]),n("AutoAdjudication")],1)])])])])},ne=[],ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.preview_fields,(function(e,a){return n("section",{key:a,staticClass:"mb-2"},[n("b-button-group",{staticClass:"w-100"},[n("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",left:"",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[n("span",{staticClass:"label"},e?[t._v(t._s(e))]:[t._v("Select...")])]},proxy:!0}],null,!0)},"b-dropdown",t.$attrs,!1),[t.options_length<1?n("b-dropdown-text",[t._v("No data")]):t._l(t.awailable_preview_fields,(function(i,s){return n("b-dropdown-group",{key:"cat-"+s},[n("b-dropdown-header",[n("span",[t._v(t._s(s))])]),t._l(i||[],(function(i,s){return n("b-dropdown-item-button",{key:s+"-"+i.field,attrs:{active:i.field===e,NOT_disabled:"preview_fields.indexOf(item.field)>=0"},on:{click:function(e){return t.onSetFieldClicked(a,i.field)}}},[n("span",[t._v(t._s(i.label))])])})),n("b-dropdown-divider")],2)}))],2),n("b-button",{staticClass:"delete-button",attrs:{size:"sm",variant:"outline-secondary",NOT_disabled:"total_preview_fields<=1"},on:{click:function(e){return t.onDeletePreviewFieldClicked(a)}}},[n("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:"times"}})],1)],1)],1)})),n("b-button",{staticClass:"mt-0",attrs:{variant:"success",size:"sm",disabled:t.total_preview_fields>=t.max_preview_fields},on:{click:t.onAddPreviewFieldClicked}},[n("font-awesome-icon",{attrs:{icon:"plus-circle"}}),n("span",[t._v(" "+t._s(t.translations["preview_fields_add_another_field"]))])],1)],2)},ie=[],se={components:{DropDown:Gt},data:function(){return{max_preview_fields:5}},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(d["c"])({preview_fields:function(t){return t.settings.preview_fields},translations:function(t){return t.app_settings.translations}})),Object(d["b"])({awailable_preview_fields:"app_settings/previewFields"})),{},{options_length:function(){var t=this.awailable_preview_fields;return Array.isArray(t)?t.length:Object.values(t).length},total_preview_fields:function(){return Object(K["a"])(this.preview_fields).length}}),methods:{onSetFieldClicked:function(t,e){this.$store.dispatch("settings/setPreviewField",{index:t,field:e})},onAddPreviewFieldClicked:function(){this.$store.dispatch("settings/addPreviewField")},onDeletePreviewFieldClicked:function(t){this.$store.dispatch("settings/deletePreviewField",t)}}},re=se,oe=(n("b19f"),Object(m["a"])(re,ae,ie,!1,null,"13413ffe",null)),le=oe.exports,ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"form-inline"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.day_offset_plusminus,expression:"day_offset_plusminus"}],staticClass:"form-control ml-0",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.day_offset_plusminus=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"+-"}},[t._v("±")]),n("option",{attrs:{value:"+"}},[t._v("+")]),n("option",{attrs:{value:"-"}},[t._v("-")])]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.day_offset,expression:"day_offset"}],staticClass:"form-control ml-2",attrs:{type:"number",id:"day-offset",min:t.day_offset_min,max:t.day_offset_max,step:t.day_offset_min,required:""},domProps:{value:t.day_offset},on:{input:function(e){e.target.composing||(t.day_offset=e.target.value)}}}),n("span",{staticClass:"ml-2"},[t._v(t._s(t.translations["days"]))]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.day_offset,expression:"day_offset"}],staticClass:"custom-range",attrs:{type:"range",min:t.day_offset_min,max:t.day_offset_max,step:t.day_offset_min},domProps:{value:t.day_offset},on:{__r:function(e){t.day_offset=e.target.value}}})]),n("span",[t._v(t._s(t.day_offset_text))])])},de=[],ue=(n("5319"),{data:function(){return{}},computed:Object(c["a"])(Object(c["a"])({},Object(d["c"])({translations:function(t){return t.app_settings.translations},day_offset_min:function(t){return t.app_settings.day_offset_min},day_offset_max:function(t){return t.app_settings.day_offset_max}})),{},{day_offset:{get:function(){return this.$store.state.settings.realtime_webservice_offset_days},set:function(t){this.$store.dispatch("settings/setOffsetDays",t)}},day_offset_plusminus:{get:function(){return this.$store.state.settings.realtime_webservice_offset_plusminus},set:function(t){this.$store.dispatch("settings/setOffsetPlusminus",t)}},day_offset_text:function(){var t=this.translations.min_max_days;if(t){for(var e={min_days:this.day_offset_min,min_minutes:Math.ceil(14.4),max_days:this.day_offset_max},n=0,a=Object.entries(e);n<a.length;n++){var i=Object(X["a"])(a[n],2),s=i[0],r=i[1];t=t.replace("{{".concat(s,"}}"),r)}return t}}})}),pe=ue,fe=Object(m["a"])(pe,ce,de,!1,null,null,null),_e=fe.exports,me=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.is_allowed?t._e():n("div",{staticClass:"alert alert-warning"},[n("span",{staticClass:"font-weight-bold d-block"},[t._v("Attention")]),n("span",[t._v("Instant adjudication is disabled in REDCap. Please enable it in the CDIS setting page if you want to use this feature.")])]),n("div",[n("b-dropdown",{staticClass:"d-block",attrs:{variant:t.auto_adjudication_enabled?"success":"danger",disabled:!t.can_be_enabled,size:"sm"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.auto_adjudication_enabled?n("span",{staticClass:"label"},[t._v(t._s(t.translations["instant_adjudication_enabled"]))]):n("span",{staticClass:"label"},[t._v(t._s(t.translations["instant_adjudication_disabled"]))])]},proxy:!0}])},[n("b-dropdown-item-button",{attrs:{active:0==t.auto_adjudication_enabled},on:{click:function(e){return t.setAutoAdjudication(!1)}}},[n("span",[n("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:"minus-circle"}}),t._v(" "+t._s(t.translations["instant_adjudication_disabled_text"]))],1)]),n("b-dropdown-item-button",{attrs:{active:1==t.auto_adjudication_enabled},on:{click:function(e){return t.setAutoAdjudication(!0)}}},[n("span",[n("font-awesome-icon",{staticClass:"text-success",attrs:{icon:"check-circle"}}),t._v(" "+t._s(t.translations["instant_adjudication_enabled_text"]))],1)])],1),n("span",{domProps:{innerHTML:t._s(t.total_selected_fields_text)}})],1),t.can_be_enabled?t._e():n("span",{staticClass:"small text-muted"},[t._v(t._s(t.translations["instant_adjudication_disabled_description"]))])])},ve=[],be={data:function(){return{}},computed:Object(c["a"])(Object(c["a"])({},Object(d["c"])({translations:function(t){return t.app_settings.translations},temporal_mapping:function(t){var e=Object(K["a"])(t.mapping.list);return e.filter((function(t){return t.is_temporal}))},total_selected_fields_text:function(){var t=this.translations.instant_adjudication_total_selected_fields;if(t){for(var e={fields:this.enabled_temporal_mapping.length,total_fields:this.temporal_mapping.length},n=0,a=Object.entries(e);n<a.length;n++){var i=Object(X["a"])(a[n],2),s=i[0],r=i[1];t=t.replace("{{".concat(s,"}}"),"<strong>".concat(r,"</strong>"))}return t}}})),{},{enabled_temporal_mapping:function(){var t=this.temporal_mapping,e=t.filter((function(t){var e=t.temporal_field,n=t.preselect;return 0!=Boolean(e)&&0!=Boolean(n)}));return e},can_be_enabled:function(){if(this.enabled_temporal_mapping.length<1)return!1;var t=this.temporal_mapping.length===this.enabled_temporal_mapping.length;return Boolean(this.is_allowed&&t)},is_allowed:function(){var t=this.$store.state.app_settings.project,e=t.fhir_cdp_auto_adjudication_allowed;t.fhir_cdp_auto_adjudication_enabled;return e},auto_adjudication_enabled:{get:function(){return 1==this.$store.state.settings.fhir_cdp_auto_adjudication_enabled},set:function(t){this.setAutoAdjudication(t)}}}),methods:{setAutoAdjudication:function(t){this.$store.dispatch("settings/setAutoAdjudication",t)}},watch:{can_be_enabled:{immediate:!0,handler:function(t){!1===t&&this.setAutoAdjudication(!1)}}}},he=be,ge=Object(m["a"])(he,me,ve,!1,null,null,null),we=ge.exports,ye={components:{PreviewFields:le,DaysOffset:_e,AutoAdjudication:we},data:function(){return{auto_adjudication:!1,preview_fields:[]}},computed:Object(c["a"])(Object(c["a"])({},Object(d["c"])({translations:function(t){return t.app_settings.translations},fhirSourceName:function(t){return t.app_settings.fhir_source_name},project:function(t){return t.app_settings.project},fhir_cdp_auto_adjudication_enabled:function(t){return t.app_settings.project.fhir_cdp_auto_adjudication_enabled}})),Object(d["b"])({project_preview_fields:"settings/previewFields"})),watch:{fhir_cdp_auto_adjudication_enabled:{immediate:!0,handler:function(t){this.auto_adjudication=Boolean(t)}}}},je=ye,xe=(n("d42c"),Object(m["a"])(je,ee,ne,!1,null,"4154f2e2",null)),Ce=xe.exports,ke=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-group",[n("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:t.importClicked}},[n("font-awesome-icon",{attrs:{icon:"file-import"}}),t._v(" Import")],1),n("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:t.exportClicked}},[n("font-awesome-icon",{attrs:{icon:"file-export"}}),t._v(" Export")],1)],1),n("input",{ref:"file",staticClass:"d-none",attrs:{type:"file"},on:{change:t.onFileChanged}}),n("b-modal",{attrs:{id:"download-modal",title:"Mapping export","ok-title":"Download","button-size":"sm"},on:{ok:t.onDownloadOkClicked}},[n("div",{staticClass:"text-center"},[n("h6",{staticClass:"my-4"},[t._v("Your data is ready to be downloaded!")]),n("div",{staticClass:"d-flex flex-column align-content-center justify-content-center"},[n("a",{staticClass:"mx-auto text-center text-primary",attrs:{href:t.download_url,download:""}},[n("font-awesome-icon",{attrs:{icon:"file-csv",size:"5x"}}),n("span",{staticClass:"d-block"},[t._v("click here to download")])],1)])])])],1)},Oe=[],$e=n("d3e3"),Fe={data:function(){return{download_url:null}},methods:{importClicked:function(){this.$refs.file.value=null,this.$refs.file.click()},onFileChanged:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,a,i,s,r,o,l,c,d,u,p,f,_,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$refs.file.files,!(n.length<1)){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,a=n[0],t.next=7,e.$API.dispatch("settings/importMapping",a);case 7:return i=t.sent,s=i.data,s=void 0===s?{}:s,r=s.imported,o=void 0===r?[]:r,l=o.length,c="Total imported mapping: ".concat(l),d="Import process completed",t.next=16,e.$bvModal.msgBoxOk(c,{title:d});case 16:$e["a"].$emit("settings:updated"),t.next=25;break;case 19:t.prev=19,t.t0=t["catch"](3),u="","string"===typeof t.t0?u=t.t0:(p=t.t0.response,p=void 0===p?{}:p,f=p.data,_=void 0===f?{}:f,u=_.message||"error importing data"),m="Import error",e.$bvModal.msgBoxOk(u,{title:m});case 25:case"end":return t.stop()}}),t,null,[[3,19]])})))()},exportClicked:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.download_url=null,e.next=3,t.$API.dispatch("settings/exportMapping");case 3:n=e.sent,a=n.data,a=void 0===a?{}:a,i=a.download_url,s=void 0===i?"":i,t.download_url=s,t.$bvModal.show("download-modal");case 9:case"end":return e.stop()}}),e)})))()},onDownloadOkClicked:function(){this.download_url&&location.replace(this.download_url)}}},Se=Fe,Ee=Object(m["a"])(Se,ke,Oe,!1,null,null,null),Me=Ee.exports,Pe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.mapping_has_errors?n("div",{staticClass:"alert alert-warning d-block"},[n("span",[t._v("Attention: the current configuration needs to be revisioned. Please check the table for more information.")])]):t._e(),1!==t.recordIdentifiersInMapping.length?n("div",{staticClass:"alert alert-warning d-block"},[t.recordIdentifiersInMapping.length<1?n("span",[t._v("Attention: one field must be mapped to the 'source identifier field'.")]):n("span",[t._v("Attention: only one field can be mapped to the 'source identifier field', but "+t._s(t.recordIdentifiersInMapping.length)+" have been set.")])]):t._e(),t.duplicates_detected?n("div",{staticClass:"alert alert-warning d-block"},[t._v(" Attention: duplicates detected. Please check the table for more information. ")]):t._e(),n("div",{staticClass:"d-flex flex-row justify-content-center align-items-center text-center"},[n("button",{staticClass:"btn btn-outline-success",attrs:{type:"button",disabled:t.save_disabled},on:{click:t.onClickSave}},[n("font-awesome-icon",{attrs:{icon:"save"}}),t._v(" Save")],1),n("button",{staticClass:"btn btn-outline-secondary m-2",attrs:{type:"button"},on:{click:t.onClickCancel}},[n("font-awesome-icon",{attrs:{icon:"times-circle"}}),t._v(" Cancel")],1)]),n("b-modal",{attrs:{id:"save-modal",title:"Success","ok-only":""},on:{hidden:t.onSaveModalHidden}},[n("p",{staticClass:"my-4"},[t._v("Settings saved!")])]),n("b-modal",{attrs:{id:"error-modal",title:"Error","ok-only":""},on:{hidden:t.onErrorModalHidden}},[n("p",{staticClass:"my-4"},[t._v("There was an error saving the settings!")]),n("ul",t._l(t.error,(function(e,a){return n("li",{key:a},[t._v(t._s(a)+": "+t._s(e))])})),0)])],1)},Ne=[],Ae=(n("bf19"),{error:null}),De={data:function(){return Object(c["a"])({},Ae)},created:function(){window.addEventListener("beforeunload",this.saveBeforeLeaving)},destroyed:function(){window.removeEventListener("beforeunload",this.saveBeforeLeaving)},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(d["c"])({project:function(t){return t.app_settings.project},mapping:function(t){return t.mapping.list},preview_fields:function(t){return t.settings.preview_fields},fhir_cdp_auto_adjudication_enabled:function(t){return t.settings.fhir_cdp_auto_adjudication_enabled},realtime_webservice_offset_days:function(t){return t.settings.realtime_webservice_offset_days},realtime_webservice_offset_plusminus:function(t){return t.settings.realtime_webservice_offset_plusminus}})),Object(d["b"])({recordIdentifiersInMapping:"mapping/recordIdentifiers",mappingConfigurationErrors:"mapping/getConfigurationErrors",mapping_duplicates:"mapping/duplicates",mapping_is_dirty:"mapping/is_dirty"})),{},{duplicates_detected:function(){return this.mapping_duplicates.length>0},mapping_has_errors:function(){var t=this.mappingConfigurationErrors;return t.length>0},save_disabled:function(){var t=this.recordIdentifiersInMapping.length;return Boolean(this.mapping_has_errors||1!==t||this.duplicates_detected)}}),methods:{saveBeforeLeaving:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.mapping_is_dirty){n.next=2;break}return n.abrupt("return",!0);case 2:t.preventDefault(),a="You have unsaved mapping; please confirm that you want to leave this page without saving.",t.returnValue=a;case 5:case"end":return n.stop()}}),n)})))()},reset:function(){for(var t=0,e=Object.entries(Ae);t<e.length;t++){var n=Object(X["a"])(e[t],2),a=n[0],i=n[1];this[a]=i}},showSuccessModal:function(){this.$bvModal.show("save-modal")},onSaveModalHidden:function(){$e["a"].$emit("settings:saved")},onErrorModalHidden:function(){$e["a"].$emit("settings:error")},onClickSave:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,a,i,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.reset(),n={preview_fields:t.preview_fields,fhir_cdp_auto_adjudication_enabled:t.fhir_cdp_auto_adjudication_enabled,realtime_webservice_offset_days:t.realtime_webservice_offset_days,realtime_webservice_offset_plusminus:t.realtime_webservice_offset_plusminus},a=Object(K["a"])(t.mapping),e.next=6,t.$API.dispatch("settings/set",{settings:n,mapping:a});case 6:e.sent,t.$bvModal.show("save-modal"),e.next=19;break;case 10:e.prev=10,e.t0=e["catch"](0),i=e.t0.response,i=void 0===i?{}:i,s=i.data,r=void 0===s?{}:s,t.error=r,t.$bvModal.show("error-modal"),console.error(e.t0.toJSON()),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,10]])})))()},onClickCancel:function(){$e["a"].$emit("settings:canceled")}}},Ie=De,Te=(n("6cd5"),Object(m["a"])(Ie,Pe,Ne,!1,null,"071376ce",null)),ze=Te.exports,Re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{"title-html":t.title,"ok-only":"",size:"lg"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("div",{domProps:{innerHTML:t._s(t.content)}})])},Le=[],He={data:function(){return{title:"",content:"",visible:!1}},methods:{open:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getInfo();case 2:t.visible=!0;case 3:case"end":return e.stop()}}),e)})))()},getInfo:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,a,i,s,r,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=null;try{n=t.$store.state.app_settings.project.realtime_webservice_type}catch(c){n="fhir"}return e.next=4,t.$API.dispatch("settings/getInfoPage",n);case 4:a=e.sent,i=a.data,i=void 0===i?{}:i,s=i.title,r=void 0===s?"":s,o=i.content,l=void 0===o?"":o,t.title=r,t.content=l;case 10:case"end":return e.stop()}}),e)})))()}}},Be=He,Ve=Object(m["a"])(Be,Re,Le,!1,null,null,null),qe=Ve.exports,Ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("span",{staticClass:"d-block",domProps:{innerHTML:t._s(t.text_with_links)}}),n("b-button",{staticClass:"text-white",attrs:{href:t.mapping_helper_url,variant:"info",size:"sm"}},[n("font-awesome-icon",{attrs:{icon:["fas","code-branch"]}}),n("span",[t._v(" Mapping Helper")])],1)],1)},Je=[],Ye={computed:{translations:function(){return this.$store.state.app_settings.translations},mapping_helper_url:function(){return this.$store.state.app_settings.mapping_helper_url},text:function(){var t=this.translations.cdp_settings_mapping_helper_text,e=void 0===t?"":t;return e},text_with_links:function(){var t=String(this.text),e="Mapping Helper",n=new RegExp(e,"ig"),a=this.mapping_helper_url,i='<a href="'.concat(a,'">').concat(e,"</a>"),s=t.replace(n,i);return s}}},Ke=Ye,Qe=Object(m["a"])(Ke,Ge,Je,!1,null,null,null),Ue=Qe.exports,We={components:{MappingTable:te,SettingsTable:Ce,ImportExport:Me,SaveCancel:ze,MappingHelperPanel:Ue,CDPInfoModal:qe},computed:{translations:function(){return this.$store.state.app_settings.translations},mapping_helper_url:function(){return this.$store.state.app_settings.mapping_helper_url}},methods:{onTellMeMoreClicked:function(){var t=this.$refs["info-modal"];t&&t.open()}}},Xe=We,Ze=Object(m["a"])(Xe,a,i,!1,null,null,null);e["default"]=Ze.exports},ccbb:function(t,e,n){},cd68:function(t,e,n){},d42c:function(t,e,n){"use strict";var a=n("72b1"),i=n.n(a);i.a},d5d6:function(t,e,n){},e662:function(t,e,n){"use strict";var a=n("554b"),i=n.n(a);i.a},effd:function(t,e,n){"use strict";var a=n("d5d6"),i=n.n(a);i.a},f57a:function(t,e,n){"use strict";var a=n("21b9"),i=n.n(a);i.a},fbcc:function(t,e,n){}}]);
//# sourceMappingURL=cdp_mapping_vue.umd.min.1.js.map